trigger:
- main

pool:
  vmImage: 'ubuntu-latest'

steps:
# 1. Checkout repo
- checkout: self

# 2. Zip JUST the contents of /web (not the folder itself)
- task: ArchiveFiles@2
  displayName: 'Create frontend deployment zip'
  inputs:
    rootFolderOrFile: '$(Build.SourcesDirectory)/web'
    includeRootFolder: false            # <â€” important
    archiveType: zip
    archiveFile: '$(Build.ArtifactStagingDirectory)/frontend.zip'
    replaceExistingArchive: true

# 3. Deploy to frontend App Service
- task: AzureWebApp@1
  displayName: 'Deploy Frontend to Azure App Service'
  inputs:
    azureSubscription: 'gpportal-frontend-connection'   # your service connection name
    appName: 'gpportal-frontend'                        # EXACTLY as in Azure
    package: '$(Build.ArtifactStagingDirectory)/frontend.zip'
    appType: 'webAppLinux'
